


{% extends 'loja/base.html' %}
{% load static %}
{% block extra_css %}
    <link rel="stylesheet" href="{% static 'loja/css/catalogo.css' %}">
    <link rel="stylesheet" href="{% static 'loja/css/produto-detalhe.css' %}">
{% endblock %}


{% block content %}

<div class="produto-wrapper">
    
    <!-- LADO ESQUERDO: FOTOS -->
    <div class="galeria-fotos">
        <div class="foto-principal">
            {% if produto.imagem %}
                <img src="{{ produto.imagem.url }}" alt="{{ produto.nome }}">
            {% else %}
                <div style="padding:50px; text-align:center; background:#eee;">Sem Foto</div>
            {% endif %}
        </div>
        
        <!-- Espaço para miniaturas (se você criar um model de fotos extras depois) -->
        <div class="miniaturas">
            <!-- Exemplo estático: -->
            <!-- <img src="..." class="miniatura"> -->
        </div>
    </div>

    <!-- LADO DIREITO: TEXTOS -->
    <div class="info-produto">
        <div class="prod-categoria">{{ produto.categoria.nome }}</div>
        <h1 class="prod-titulo">{{ produto.nome }}</h1>
        <div class="prod-preco">R$ {{ produto.preco }}</div>
        <div class="botoes-acao">
            <!-- Botão Adicionar ao Carrinho -->
            <form action="{% url 'carrinho_adicionar' produto.id %}" method="post" style="flex:1; display:flex;">
                {% csrf_token %}
                <button type="submit" class="btn-grandao btn-sacola">
                    Adicionar ao Carrinho
                </button>
            </form>

            <!-- Botão Comprar (WhatsApp) -->
            <a href="https://wa.me/5593992434424?text=Olá! Quero comprar: {{ produto.nome }} (R$ {{ produto.preco }})" target="_blank" class="btn-grandao btn-compra">
                Comprar Agora
            </a>
        </div>

        <div class="prod-descricao">
            <!-- Usa linebreaks para manter os parágrafos do texto -->
            {{ produto.descricao|linebreaks }}
        </div>

        
    </div>
</div>

<!-- CATÁLOGO ABAIXO DO DETALHE (PRODUTOS RELACIONADOS) -->
{% if relacionados %}
<div class="catalogo-wrapper" style="margin-top: 60px;">
    
    <h2 class="titulo-sessao">Você também pode gostar</h2>

    <div class="grid-produtos">
        {% for p in relacionados %}
            <div class="card-produto">
                <!-- Imagem com link -->
                <div class="card-img-wrapper">
                    <a href="{% url 'produto_detalhe' p.id %}" style="display:block; width:100%; height:100%;">
                        {% if p.imagem %}
                            <img src="{{ p.imagem.url }}" alt="{{ p.nome }}">
                        {% else %}
                            <span style="color:#ccc;">Sem Foto</span>
                        {% endif %}
                    </a>
                </div>

                <!-- Conteúdo -->
                <div class="card-content">
                    <div class="card-category">{{ p.categoria.nome }}</div>

                    <h3 class="card-title">
                        <a href="{% url 'produto_detalhe' p.id %}" style="text-decoration:none; color:inherit;">
                            {{ p.nome }}
                        </a>
                    </h3>

                    <div class="card-price-row">
                        <span class="card-price">R$ {{ p.preco }}</span>
                    </div>

                    <div class="card-actions">
                        <!-- Adicionar ao carrinho -->
                        <form action="{% url 'carrinho_adicionar' produto.id %}" method="post" style="flex:1; display:flex;">
                            {% csrf_token %}
                        <input type="hidden" name="next" value="{{ request.get_full_path }}">
                        <button type="submit" class="btn-grandao btn-sacola">
                             Adicionar ao carrinho 
                         </button>
                        </form>


                        <!-- Comprar via WhatsApp -->
                        <a href="https://wa.me/5593992434424?text=Olá! Gostei do produto: {{ p.nome }} (R$ {{ p.preco }})" 
                           class="btn-action btn-buy" target="_blank">
                           Comprar
                        </a>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

</div>
{% endif %}



{% endblock %}
